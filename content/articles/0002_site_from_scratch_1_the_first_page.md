id:     site-from-scratch-1-the-first-page
title:  Site from Scratch 1: The First Page
date:   July 31, 2010
tags:   site,development
status: draft


### Introduction

In building site, as in any other business, it's hard to begin from the blank page.
To simplify the process I'm going to start creating only one page with only one paragraph of text.
Nothing can be simplier, isn't it? So the step is going to be small and easy.

On the other hand, it's important to start in the right direction
so the page should contain well formed HTML generated by Django template
and styled with a separate CSS sheet.

### Preparing the Stage

To play with source code from this article you need have [Python][python] and [Google App Engine][app-engine] installed.

Example's source is located in the git repository [here on GitHub][siteSample] 
and I would recommend to clone it on hard drive:

    git clone git@github.com:yushchenko/siteSample.git

For every interesting point a separate branch will be created,
so the reader will be able to trace all history simply switching between the branches.

By the way, if you are willing to explore site's code itself, it can be found [here][site].

Having preparations done let's begin with the first page.

### Starting from URL

As according the old russian proverb a theater starts from the wardrobe, as a site starts from its URL.

First of all, the address should be as short as it possible, so own domain name is required.
Having spent a couple of hours for investigations, I decided to use [name.com][name.com] registar.
I liked their relatively simple and fast site and also 'bike-to-work incentive program'
described in [the wikipedia article][name-com-wiki].
Our decisions are sometimes driven by strange motives...

Next, the resource part of the URL should be short and verbose.
For example, link to this article should look something like this:

    yushchenko.name/blog/site-from-scratch-1-the-first-page

Short, helps the user to understand where he's now and even not so hard to type.

The connection between a nice url and application's code is usually called 'URL routing'.
For [Google App Engine][app-engine] it can be configured either in `app.yaml` configuration file or
in webapp framework configuration.
The simplest routing contains just three lines of code:

    handlers:
    - url: /.*                # take any request to the site
      script: main.py         # and run code from main.py to generate response

Besides this at the begining of the `app.yaml` should be description of the app:

    application: site
    version: 1

and its runtime:

    runtime: python
    api_version: 1

Now basic configuration is done
and the site's ready to respond on incoming requests executing code in `main.py`
so it's a nice time to proceed with the next step.

### Markup Generation

App Engine Webapp framework includes Django templates engine.
It's a powerfull mean of generation text in any format including HTML and CSS.
As you remember, the initial step should be in the right direction so
the first Django's feature I'm going to use is [template enheritance][django-template-inheritance].
In nutshell, it allows create many pages with the same structure but different content.

Let's split page markup in two parts -
`master.html` contains doctype and all tags required for well formed html document
plus simple grid's markup for using YUI CSS framework:

    <!DOCTYPE html>                          {% templatetag opencomment %} let's imagine that HTML5 is already with us #}
    <html lang="en">
      <head>
        ...                                  {% templatetag opencomment %} links to ccs style sheets #}
        <title>{% templatetag openblock %} block title % }Valery Yushchenko{% templatetag openblock %} endblock % }</title>
      </head>
      <body>
        <div id="doc">
    
          <div id="hd">
          ...                                {% templatetag opencomment %} header content #}
          </div>
    
          <div id="bd">
            {% templatetag openblock %} block content %}{% templatetag openblock %} endblock %}
          </div>
    
          <div id="ft">
          ...                                {% templatetag opencomment %} footer content #}
          </div>
    
        </div>
      </body>
    </html>

`home.html` template inherits from `master.html` and provides contents for master's blocks:

    {% templatetag openblock %} extends "master.html" %}
    
    {% templatetag openblock %} block content %}

    Hello World!                             {% templatetag opencomment %} text to display #}
    
    {% templatetag openblock %} endblock %}
    
Now let's allow Django render the page putting the following code into `main.py`:

    import os
    from google.appengine.ext.webapp import template
    
    home_file = os.path.join(os.path.dirname(__file__), 'markup/home.html')
    
    print 'Content-Type: text/html'           # let the browser know that it's getting html
    print ''
    print template.render(home_file, {})      # return response content - the text itself


At this point, there are four files in applicaiton's directory:

    .../siteSample:
    -rw-rw-rw- 115 Jul 21 08:13 app.yaml
    -rw-rw-rw-  86 Jul 21 08:18 home.html
    -rw-rw-rw- 321 Jul 21 08:30 main.py
    -rw-rw-rw- 814 Jul 21 08:17 master.html

and the application is ready to run.

If you have cloned [sample's repo][siteSample], simply switch to branch [example1][example1] and type the following command:

    dev_appserver.py siteSample

To look at the result of our efforts visit `http://localhost:8080/`.

Looks not so good, doesn't it? 
So, it's a good moment to style our page.

### Adding Styles

Styling HTML page might be a tricky business.
There are several popular browsers around and every of them has its own opinion how to treat certain details of CSS.
It's definitely not a big issue for the page with one paragraph of text
but I would like to avoid problems in the future mainly
because tinkering with styles is not so interesting as, for example, programming or writing.

The best way to save time and simplify life is usage of existing CSS framework.
So, let's ask guys from, for instance, Yahoo for help adding the following line into head of our page:

    <link rel="stylesheet" type="text/css"
          href="http://yui.yahooapis.com/combo?
          2.8.1/build/reset-fonts-grids/reset-fonts-grids.css&2.8.1/build/base/base-min.css">

It tells the browser load the file directly from Yahoo's content distribution network (CDN).
Checkout branch with [example #2][example2] and see how the page looks styled by YUI 2 CSS framework.

YUI CSS [Reset][yui-reset] helps to minimize browser's particularities making further work easier,
[Base][yui-base] and [Font][yui-fonts] modules make standard HTML elemnents such as headers and paragraphs look nice
and [Grids][yui-grids] CSS provides simple fixed size grid layout for the page.

Now the page looks better but I would like to change element's colors, margins and other minor details
adding link to own CSS table:

    <link rel="stylesheet" href="/styles/master.css" />

To make App Engine serve `master.css` file add static dir rout into `app.yaml`:

    - url: /styles
      static_dir: styles

Switch to [example3][example3] branch and run app to see fully styled "Hello World!" page.

At this point, the first small step is done.

### The next step

Any site is completely useless without content and it's reasonable to fill this gap as soon as possible.
So in the next article I'm going to find out the most convenient way to put my writing on recently created page.

### Links

0. The first article of this cycle - [Site from Scratch 0: Introduction][s0].
1. Official App Engine's tutorial can be found [here][app-engine-tutorial].
2. Django templates documentation is [here][django-doc].
3. YUI 2 CSS tools: [reset][yui-reset], [base][yui-base], [fonts][yui-fonts], [grids][yui-grids].


[python]: http://www.python.org "Python Programming Language"
[app-engine]: appengine.google.com/ "Google App Engine"

[name.com]: http://www.name.com "Name.com web site"
[name-com-wiki]:http://en.wikipedia.org/wiki/Name.com "Wiki article about Name.com"
[django-template-inheritance]:http://www.djangoproject.com/documentation/0.96/templates/#template-inheritance "Django documentation: template inheritance"

[site]: http://github.com/yushchenko/site "Full source code of this site"
[siteSample]: http://github.com/yushchenko/siteSample "Sample's repository on GitHub"
[example1]: http://github.com/yushchenko/siteSample/tree/example1 "Sample's source code: example 1 - page + master page"
[example2]: http://github.com/yushchenko/siteSample/tree/example2 "Sample's source code: example 2 - adding YUI 2 CSS Framework"
[example3]: http://github.com/yushchenko/siteSample/tree/example3 "Sample's source code: example 3 - custom styles"

[s0]: /blog/site-from-scratch-0-introduction "Site from Scratch 0: Intorduction"
[s2]: /blog/site-from-scratch-2-content "Site from Scratch 2: Content"

[app-engine-tutorial]: http://code.google.com/appengine/docs/python/gettingstarted/ "Python App Engine tutorial"
[django-doc]: http://www.djangoproject.com/documentation/0.96/templates/ "Django templates, version 0.96"
[yui-reset]: http://developer.yahoo.com/yui/reset/ "YUI 2 Reset"
[yui-base]: http://developer.yahoo.com/yui/base/ "YUI 2 Base"
[yui-fonts]: http://developer.yahoo.com/yui/fonts/ "YUI 2 Fonts"
[yui-grids]: http://developer.yahoo.com/yui/grids/ "YUI 2 Grids"

